# ================= [DATA HANDLING] =================
# Cell 7.1: Inisialisasi dan Import Data Handling

import ipywidgets as widgets
from IPython.display import display, HTML, clear_output
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import os
import gc
import sys
from pathlib import Path

# Tambahkan path ke PYTHONPATH jika belum ada
if os.getcwd() not in sys.path:
    sys.path.append(os.getcwd())

# Import modul yang diperlukan
from smartcash.utils.logger import get_logger, SmartCashLogger  
from smartcash.handlers.data_handler import DataHandler
from smartcash.utils.dataset_augmentation_utils import DatasetProcessor

# Set logger yang kompatibel dengan Colab
logger = get_logger("data_pipeline", log_to_colab=True, log_to_file=True)

# Fungsi untuk memuat config
def load_experiment_config():
    """Muat konfigurasi eksperimen dari file"""
    config_path = 'configs/experiment_config.yaml'
    try:
        with open(config_path, 'r') as f:
            import yaml
            return yaml.safe_load(f)
    except Exception as e:
        logger.error(f"Gagal memuat konfigurasi: {str(e)}")
        # Gunakan file config dasar jika eksperimen config tidak tersedia
        try:
            with open('configs/base_config.yaml', 'r') as f:
                import yaml
                return yaml.safe_load(f)
        except:
            return {}

# Inisialisasi konfigurasi dan processor
config = load_experiment_config()
dataset_processor = DatasetProcessor(
    data_dir="data",
    logger=logger
)
data_handler = DataHandler(config=config, logger=logger)

logger.info("âœ… Data handlers dan konfigurasi berhasil diinisialisasi")